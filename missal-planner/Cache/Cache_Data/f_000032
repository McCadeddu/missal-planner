
        <!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="UTF-8" />
            <title>Error</title>
            <script type="module">
              const error = {"message":"C:\\projetos\\missal-planner\\src\\App.jsx: Unterminated JSX contents. (1142:11)\n\n  1140 |             \u003cModalAddSong visible={showAddModal} onClose={() => setShowAddModal(false)} draft={newSongDraft} setDraft={setNewSongDraft} onSave={saveNewSong} />\n  1141 |             \u003cModalSelectSections visible={showSectionModal} pendingSong={pendingSong} sections={sections} pendingSelections={pendingSelections} setPendingSelections={setPendingSelections} onConfirm={confirmSectionSelection} onClose={() => setShowSectionModal(false)} />\n> 1142 |         \u003c/>\n       |            ^\n  1143 |     );\n  1144 | }\n  1145 |","stack":"    at constructor (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:367:19)\n    at JSXParserMixin.raise (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:6624:19)\n    at JSXParserMixin.jsxReadToken (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:4477:20)\n    at JSXParserMixin.getTokenFromCode (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:4803:12)\n    at JSXParserMixin.nextToken (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:5807:10)\n    at JSXParserMixin.next (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:5717:10)\n    at JSXParserMixin.eat (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:5721:12)\n    at JSXParserMixin.jsxParseClosingElementAt (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:4705:14)\n    at JSXParserMixin.jsxParseElementAt (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:4724:37)\n    at JSXParserMixin.jsxParseElementAt (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:4727:32)\n    at JSXParserMixin.jsxParseElement (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:4778:17)\n    at JSXParserMixin.parseExprAtom (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:4788:19)\n    at JSXParserMixin.parseExprSubscripts (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:11145:23)\n    at JSXParserMixin.parseUpdate (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:11130:21)\n    at JSXParserMixin.parseMaybeUnary (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:11110:23)\n    at JSXParserMixin.parseMaybeUnaryOrPrivate (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10963:61)\n    at JSXParserMixin.parseExprOps (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10968:23)\n    at JSXParserMixin.parseMaybeConditional (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10945:23)\n    at JSXParserMixin.parseMaybeAssign (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10895:21)\n    at C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10864:39\n    at JSXParserMixin.allowInAnd (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:12500:12)\n    at JSXParserMixin.parseMaybeAssignAllowIn (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10864:17)\n    at JSXParserMixin.parseMaybeAssignAllowInOrVoidPattern (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:12567:17)\n    at JSXParserMixin.parseParenAndDistinguishExpression (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:11747:28)\n    at JSXParserMixin.parseExprAtom (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:11395:23)\n    at JSXParserMixin.parseExprAtom (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:4793:20)\n    at JSXParserMixin.parseExprSubscripts (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:11145:23)\n    at JSXParserMixin.parseUpdate (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:11130:21)\n    at JSXParserMixin.parseMaybeUnary (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:11110:23)\n    at JSXParserMixin.parseMaybeUnaryOrPrivate (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10963:61)\n    at JSXParserMixin.parseExprOps (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10968:23)\n    at JSXParserMixin.parseMaybeConditional (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10945:23)\n    at JSXParserMixin.parseMaybeAssign (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10895:21)\n    at JSXParserMixin.parseExpressionBase (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10848:23)\n    at C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10844:39\n    at JSXParserMixin.allowInAnd (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:12495:16)\n    at JSXParserMixin.parseExpression (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:10844:17)\n    at JSXParserMixin.parseReturnStatement (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:13218:28)\n    at JSXParserMixin.parseStatementContent (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:12874:21)\n    at JSXParserMixin.parseStatementLike (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:12843:17)\n    at JSXParserMixin.parseStatementListItem (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:12823:17)\n    at JSXParserMixin.parseBlockOrModuleBlockBody (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:13392:61)\n    at JSXParserMixin.parseBlockBody (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:13385:10)\n    at JSXParserMixin.parseBlock (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:13373:10)\n    at JSXParserMixin.parseFunctionBody (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:12174:24)\n    at JSXParserMixin.parseFunctionBodyAndFinish (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:12160:10)\n    at C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:13521:12\n    at JSXParserMixin.withSmartMixTopicForbiddingContext (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:12477:14)\n    at JSXParserMixin.parseFunction (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:13520:10)\n    at JSXParserMixin.parseExportDefaultExpression (C:\\projetos\\missal-planner\\node_modules\\@babel\\parser\\lib\\index.js:13983:19)","id":"C:/projetos/missal-planner/src/App.jsx","frame":"1140 |              \u003cModalAddSong visible={showAddModal} onClose={() => setShowAddModal(false)} draft={newSongDraft} setDraft...\n1141 |              \u003cModalSelectSections visible={showSectionModal} pendingSong={pendingSong} sections={sections} pendingSele...\n1142 |          \u003c/>\n     |             ^\n1143 |      );\n1144 |  }","plugin":"vite:react-babel","pluginCode":"import React, { useState, useEffect, useRef } from \"react\";\nimport Papa from \"papaparse\";\nimport { jsPDF } from \"jspdf\";\n\nimport Header from \"./components/Header\";\n\n// --- AUTOSAVE KEYS ---\nconst AUTOSAVE_LIBRARY = \"mp_library_v1\";\nconst SAVED_LISTS_KEY = \"mp_saved_lists_v1\";\nconst AUTOSAVE_SELECTED = \"mp_selected_v1\";\nconst AUTOSAVE_MASSNAME = \"mp_massname_v1\";\nconst AUTOSAVE_MASSDATE = \"mp_massdate_v1\";\nconst AUTOSAVE_MODE = \"mp_mode_v1\";\n\nimport LibraryPanel from \"./components/library/LibraryPanel\";\nimport Filters from \"./components/library/Filters\";\nimport SidebarPanel from \"./components/sidebar/SidebarPanel\";\nimport SelectedSongsPanel from \"./components/selected/SelectedSongsPanel\";\nimport ModalAddSong from \"./components/modals/ModalAddSong\";\nimport ModalSelectSections from \"./components/modals/ModalSelectSections\";\n\nimport cantosCSV from \"./data/cantos.csv?raw\";\n\n/* modos e seÃ§Ãµes (mantidos) */\nconst missaSections = [\n    \"Cantos para ensaiar\",\n    \"Canto de Entrada / Hino L. das Horas\",\n    \"Canto de Pedido de PerdÃ£o\",\n    \"Canto do GlÃ³ria\",\n    \"RefrÃ£o de IntroduÃ§Ã£o Ã  Palavra de Deus\",\n    \"Salmo cantado (refrÃ£o)\",\n    \"Hino litÃºrgico cantado\",\n    \"AclamaÃ§Ã£o ao Evangelho\",\n    \"RefrÃ£o para retomar a Palavra de Deus\",\n    \"Canto do OfertÃ³rio\",\n    \"Santo cantado\",\n    \"Pai nosso cantado\",\n    \"Cordeiro de Deus cantado\",\n    \"Canto de ComunhÃ£o\",\n    \"Canto de AÃ§Ã£o de GraÃ§as\",\n    \"Canto final\",\n];\n\nconst adoracaoSections = [\n    \"Cantos de AdoraÃ§Ã£o ao SantÃ­ssimo\",\n    \"Cantos de IntercessÃ£o\",\n    \"Cantos de Louvor\",\n    \"Canto final da adoraÃ§Ã£o\",\n];\n\nconst modes = {\n    missa: { label: \"Missa\", sections: missaSections },\n    adoracao: { label: \"AdoraÃ§Ã£o\", sections: adoracaoSections },\n    missaeadoracao: { label: \"Missa + AdoraÃ§Ã£o\", sections: [...missaSections, ...adoracaoSections] },\n};\n\nconst SINGLE_ONLY = new Set([\n    \"Canto do GlÃ³ria\",\n    \"AclamaÃ§Ã£o ao Evangelho\",\n    \"Santo cantado\",\n    \"Pai nosso cantado\",\n    \"Cordeiro de Deus cantado\",\n]);\n\n/* util helpers */\nfunction downloadBlob(blob, filename) {\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n    URL.revokeObjectURL(url);\n}\n\nfunction flattenSelected(selectedSongs, sectionsOrder = []) {\n    const arr = [];\n    for (const sec of sectionsOrder) {\n        const list = selectedSongs[sec] || [];\n        for (let i = 0; i \u003c list.length; i++) {\n            arr.push({\n                section: sec,\n                indexInSection: i,\n                ...list[i],\n            });\n        }\n    }\n    return arr;\n}\n\nexport default function App() {\n\n    const [songsData, setSongsData] = useState([]);\n    const [showSavedLists, setShowSavedLists] = useState(false);\n    const [savedLists, setSavedLists] = useState([]);\n    const [mode, setMode] = useState(\"missa\");\n    const [sections, setSections] = useState(modes[mode].sections);\n    const [selectedSongs, setSelectedSongs] = useState({});\n\n    const [massName, setMassName] = useState(\"\");\n    const [massDate, setMassDate] = useState(() => new Date().toISOString().slice(0, 10));\n\n    // library controls\n    const [globalSearch, setGlobalSearch] = useState(\"\");\n    const [filterCategory, setFilterCategory] = useState(\"Todas\");\n    const [filterComposer, setFilterComposer] = useState(\"\");\n    const [sortMode, setSortMode] = useState(\"added\");\n\n    // modals / pending\n    const [showAddModal, setShowAddModal] = useState(false);\n    const [newSongDraft, setNewSongDraft] = useState({ nome: \"\", numero: \"\", composer: \"\", category: \"Geral\" });\n\n    const [showSectionModal, setShowSectionModal] = useState(false);\n\n    // Modal: Eliminar canto da Biblioteca\n    const [showDeleteLibraryModal, setShowDeleteLibraryModal] = useState(false);\n    const [songToDelete, setSongToDelete] = useState(null);\n\n    const [pendingSong, setPendingSong] = useState(null);\n    const [pendingSelections, setPendingSelections] = useState({});\n\n    // Modal: InformaÃ§Ãµes do app / ajuda\n    const [showHelp, setShowHelp] = useState(false);\n\n    // settings modal\n    const [showSettings, setShowSettings] = useState(false);\n\n    const fileInputLibraryRef = useRef();\n    const fileHandleRef = useRef(null);\n\n    // --- LOAD CSV APENAS SE NUNCA HOUVE AUTOSAVE ---\n    useEffect(() => {\n        if (!cantosCSV) return;\n\n        try {\n            const parsed = Papa.parse(cantosCSV, { header: true, skipEmptyLines: true });\n            const arr = parsed.data\n                .map((r, idx) => {\n                    const nome = (r[\"NOME DO CANTO\"] ?? r[\"NOME\"] ?? \"\").toString().trim();\n                    const numero = (r[\"NÃšMERO\"] ?? r[\"NUMERO\"] ?? \"\").toString().trim();\n                    const category = (r[\"CATEGORIA\"] ?? \"Geral\").toString().trim();\n                    const composer = (r[\"COMPOSER\"] ?? \"\").toString().trim();\n                    return { id: idx + 1, numero, nome, composer, category };\n                })\n                .filter((s) => s.nome);\n\n            // SÃ³ usar CSV se nÃ£o houver biblioteca personalizada salva\n            const savedLibraryRaw = localStorage.getItem(AUTOSAVE_LIBRARY);\n\n            if (!savedLibraryRaw) {\n                setSongsData(arr);\n                console.log(\"Biblioteca inicial carregada do CSV\");\n            } else {\n                console.log(\"CSV ignorado â€” biblioteca personalizada carregada do autosave\");\n            }\n\n        } catch (e) {\n            console.error(e);\n        }\n    }, []);\n\n    // --- LOAD AUTOSAVE ON START (JSON always preferred) ---\n    useEffect(() => {\n        try {\n            // 1ï¸âƒ£ Tenta carregar biblioteca salva (JSON)\n            const savedLibraryRaw = localStorage.getItem(AUTOSAVE_LIBRARY);\n            let savedLibrary = null;\n\n            if (savedLibraryRaw) {\n                try {\n                    savedLibrary = JSON.parse(savedLibraryRaw);\n                } catch (e) {\n                    console.warn(\"Erro ao ler autosave JSON da biblioteca:\", e);\n                }\n            }\n\n            // 2ï¸âƒ£ Se existe biblioteca salva â†’ usar SEMPRE\n            if (savedLibrary && Array.isArray(savedLibrary) && savedLibrary.length > 0) {\n                setSongsData(savedLibrary);\n            }\n\n            // 3ï¸âƒ£ Caso contrÃ¡rio â†’ usa CSV embutido (primeiro uso)\n            else {\n                console.log(\"Usando biblioteca padrÃ£o do CSV (primeira inicializaÃ§Ã£o).\");\n                // Nada a fazer: o CSV serÃ¡ carregado pelo outro useEffect automaticamente\n            }\n\n            // --- Outros autosaves (iguais ao seu cÃ³digo atual) ---\n            const savedSelected = localStorage.getItem(AUTOSAVE_SELECTED);\n            if (savedSelected) setSelectedSongs(JSON.parse(savedSelected));\n\n            const savedMassName = localStorage.getItem(AUTOSAVE_MASSNAME);\n            if (savedMassName) setMassName(savedMassName);\n\n            const savedMassDate = localStorage.getItem(AUTOSAVE_MASSDATE);\n            if (savedMassDate) setMassDate(savedMassDate);\n\n            const savedMode = localStorage.getItem(AUTOSAVE_MODE);\n            if (savedMode && modes[savedMode]) {\n                setMode(savedMode);\n                setSections(modes[savedMode].sections);\n            }\n\n        } catch (e) {\n            console.warn(\"Erro ao carregar autosave:\", e);\n        }\n    }, []);\n\n    // --- SISTEMA DE LISTAS SALVAS ------------------------------------\n    const getSavedLists = () => {\n        try {\n            const raw = localStorage.getItem(SAVED_LISTS_KEY);\n            return raw ? JSON.parse(raw) : [];\n        } catch {\n            return [];\n        }\n    };\n\n    const saveCurrentList = () => {\n        try {\n            const lists = getSavedLists();\n\n            const newEntry = {\n                id: Date.now(),\n                missa: massName || \"Sem nome\",\n                data: massDate,\n                cantos: selectedSongs\n            };\n\n            const next = [newEntry, ...lists];\n            localStorage.setItem(SAVED_LISTS_KEY, JSON.stringify(next));\n            setSavedLists(next);\n\n            alert(\"Lista salva com sucesso!\");\n        } catch (e) {\n            console.error(\"Erro ao salvar lista:\", e);\n            alert(\"Erro ao salvar lista.\");\n        }\n    };\n\n    const openSavedList = (entry) => {\n        if (!entry) return;\n        setMassName(entry.missa || \"\");\n        setMassDate(entry.data || new Date().toISOString().slice(0, 10));\n        setSelectedSongs(entry.cantos || {});\n        setShowSavedLists(false);\n    };\n\n    const deleteSavedList = (id) => {\n        const lists = getSavedLists().filter(l => l.id !== id);\n        localStorage.setItem(SAVED_LISTS_KEY, JSON.stringify(lists));\n        setSavedLists(lists);\n    };\n\n\n    // --- AUTOSAVE LIBRARY (salva JSON automaticamente quando modificada) ---\n    useEffect(() => {\n        try {\n            localStorage.setItem(AUTOSAVE_LIBRARY, JSON.stringify(songsData));\n        } catch (e) {\n            console.warn(\"Erro ao salvar biblioteca:\", e);\n        }\n    }, [songsData]);\n\n    // --- GARANTIR QUE TODO CANTO NA LISTA EXISTE NA BIBLIOTECA ---\n    useEffect(() => {\n        const flatSelected = flattenSelected(selectedSongs, sections);\n\n        setSongsData(prev => {\n            const existingIds = new Set(prev.map(s => s.id));\n            const newOnes = [];\n\n            for (const item of flatSelected) {\n                if (!existingIds.has(item.id)) {\n                    newOnes.push({\n                        id: item.id,\n                        numero: item.numero || \"\",\n                        nome: item.nome || \"\",\n                        composer: item.composer || \"\",\n                        category: item.category || \"Geral\",\n                    });\n                }\n            }\n\n            if (newOnes.length > 0) {\n                return [...prev, ...newOnes];\n            }\n\n            return prev;\n        });\n    }, [selectedSongs]);\n\n    // --- AUTOSAVE SELECTED SONGS ---\n    useEffect(() => {\n        try {\n            localStorage.setItem(AUTOSAVE_SELECTED, JSON.stringify(selectedSongs));\n        } catch (e) { }\n    }, [selectedSongs]);\n\n    // --- AUTOSAVE MASS NAME ---\n    useEffect(() => {\n        try {\n            localStorage.setItem(AUTOSAVE_MASSNAME, massName);\n        } catch (e) { }\n    }, [massName]);\n\n    // --- AUTOSAVE MASS DATE ---\n    useEffect(() => {\n        try {\n            localStorage.setItem(AUTOSAVE_MASSDATE, massDate);\n        } catch (e) { }\n    }, [massDate]);\n\n    // --- AUTOSAVE MODE ---\n    useEffect(() => {\n        try {\n            localStorage.setItem(AUTOSAVE_MODE, mode);\n        } catch (e) { }\n    }, [mode]);\n\n    // --- AUTOSAVE LIBRARY ---\n    useEffect(() => {\n        try {\n            localStorage.setItem(AUTOSAVE_LIBRARY, JSON.stringify(songsData));\n        } catch (e) { }\n    }, [songsData]);\n\n    // --- UPDATE SECTIONS ON MODE CHANGE ---\n    useEffect(() => {\n        setSections(modes[mode].sections);\n        setSelectedSongs((prev) => {\n            const copy = { ...prev };\n            for (const sec of Object.keys(copy)) {\n                if (!modes[mode].sections.includes(sec)) delete copy[sec];\n            }\n            return copy;\n        });\n    }, [mode]);\n\n    /* filtered songs for library */\n    const filteredSongs = songsData\n        .filter((s) => {\n            if (filterCategory && filterCategory !== \"Todas\" && s.category !== filterCategory) return false;\n            if (filterComposer && !s.composer.toLowerCase().includes(filterComposer.toLowerCase())) return false;\n            if (globalSearch) {\n                const q = globalSearch.toLowerCase();\n                return (s.nome || \"\").toLowerCase().includes(q) || (s.numero || \"\").toLowerCase().includes(q) || (s.composer || \"\").toLowerCase().includes(q);\n            }\n            return true;\n        })\n        .sort((a, b) => {\n            if (sortMode === \"nome\") return a.nome.localeCompare(b.nome);\n            if (sortMode === \"numero\") return a.numero.localeCompare(b.numero);\n            return 0;\n        });\n\n    const categoriesList = Array.from(new Set([\"Geral\", ...songsData.map((s) => s.category)]));\n\n    /* actions */\n    const openSectionModalForSong = (song) => {\n        setPendingSong(song);\n        const initial = {};\n        for (const s of sections) initial[s] = false;\n        setPendingSelections(initial);\n        setShowSectionModal(true);\n    };\n\n    const confirmSectionSelection = () => {\n        if (!pendingSong) return;\n        const chosen = Object.keys(pendingSelections).filter((k) => pendingSelections[k]);\n        if (chosen.length === 0) {\n            alert(\"Escolha ao menos uma seÃ§Ã£o.\");\n            return;\n        }\n\n        setSelectedSongs((prev) => {\n            const next = { ...prev };\n            for (const sec of chosen) {\n                if (SINGLE_ONLY.has(sec)) {\n                    next[sec] = [{ ...pendingSong }];\n                } else {\n                    next[sec] = Array.isArray(next[sec]) ? [...next[sec], { ...pendingSong }] : [{ ...pendingSong }];\n                }\n            }\n            return next;\n        });\n\n        setShowSectionModal(false);\n        setPendingSong(null);\n    };\n\n    const removeFromSection = (section, index = null) => {\n        setSelectedSongs((prev) => {\n            const copy = { ...prev };\n            if (!copy[section]) return copy;\n            if (index === null) {\n                delete copy[section];\n            } else {\n                const arr = [...copy[section]];\n                arr.splice(index, 1);\n                if (arr.length === 0) delete copy[section];\n                else copy[section] = arr;\n            }\n            return copy;\n        });\n    };\n\n    const openEditSelectedItem = (section, index) => {\n        const item = selectedSongs[section] && selectedSongs[section][index];\n        if (!item) return;\n        alert(\"Editar: \" + (item.nome || \"\"));\n    };\n\n    const openDeleteLibraryModal = () => {\n        setShowDeleteLibraryModal(true);\n    };\n\n    const saveNewSong = () => {\n        if (!newSongDraft.nome || newSongDraft.nome.trim().length === 0) {\n            alert(\"Nome vazio\");\n            return;\n        }\n        setSongsData((prev) => [...prev, { id: prev.length + 1, ...newSongDraft }]);\n        setShowAddModal(false);\n        setNewSongDraft({ nome: \"\", numero: \"\", composer: \"\", category: \"Geral\" });\n    };\n\n    const handleLibraryAdd = (song) => {\n        openSectionModalForSong(song);\n    };\n\n    const handleLibraryEdit = (song) => {\n        setNewSongDraft({ nome: song.nome, numero: song.numero, composer: song.composer || \"\", category: song.category || \"Geral\" });\n        setShowAddModal(true);\n    };\n\n    // --- DELETE SONG FROM LIBRARY (CORRIGIDO) ---\n    const deleteSongFromLibrary = (id) => {\n        // Remove da biblioteca\n        setSongsData(prev => prev.filter(song => song.id !== id));\n\n        // Remove de qualquer seÃ§Ã£o selecionada\n        setSelectedSongs(prev => {\n            const out = {};\n            for (const key in prev) {\n                const arr = prev[key].filter(song => song.id !== id);\n                if (arr.length > 0) out[key] = arr;\n            }\n            return out;\n        });\n    };\n\n    /* ------------------ CSV: export/import biblioteca ------------------ */\n\n    // Exportar biblioteca como CSV (compositor + categoria + nomenclatura padronizada)\n    const exportLibraryAsCSV = () => {\n        const rows = songsData.map((s) => ({\n            \"NÃšMERO\": s.numero || \"\",\n            \"NOME DO CANTO\": s.nome || \"\",\n            \"COMPOSITOR\": s.composer || \"\",\n            \"CATEGORIA\": s.category || \"Geral\",\n        }));\n\n        const csv = Papa.unparse(rows, { header: true });\n\n        const blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\n        downloadBlob(blob, `biblioteca_atualizada_${new Date().toISOString().slice(0, 10)}.csv`);\n    };\n\n    // Importar CSV para biblioteca (apenas colunas: numero, nome, category, composer sÃ£o lidas)\n    const importLibraryCSV = (file) => {\n        if (!file) return;\n\n        Papa.parse(file, {\n            header: true,\n            skipEmptyLines: true,\n            complete: (results) => {\n                const arr = results.data\n                    .map((r, idx) => {\n                        const nome = (r[\"NOME DO CANTO\"] ?? r[\"NOME\"] ?? \"\").toString().trim();\n                        if (!nome) return null;\n\n                        return {\n                            id: Date.now() + idx, // sempre id Ãºnico\n                            numero: (r[\"NÃšMERO\"] ?? r[\"NUMERO\"] ?? \"\").toString().trim(),\n                            nome,\n                            composer: (r[\"COMPOSITOR\"] ?? \"\").toString().trim(),\n                            category: (r[\"CATEGORIA\"] ?? \"Geral\").toString().trim(),\n                        };\n                    })\n                    .filter(Boolean);\n\n                if (arr.length > 0) {\n                    setSongsData((prev) => [...prev, ...arr]);\n                }\n\n                alert(`Importados ${arr.length} cantos para a biblioteca.`);\n            },\n            error: (e) => alert(\"Erro ao importar CSV: \" + e.message),\n        });\n    };\n    // Exportar biblioteca completa em JSON\n    const exportLibraryJSON = () => {\n        const blob = new Blob([JSON.stringify(songsData, null, 2)], {\n            type: \"application/json\",\n        });\n\n        downloadBlob(\n            blob,\n            `biblioteca_cantos_${new Date().toISOString().slice(0, 10)}.json`\n        );\n    };\n\n    // Importar biblioteca completa em JSON\n    const importLibraryJSON = (file) => {\n        if (!file) return;\n\n        const reader = new FileReader();\n\n        reader.onload = (e) => {\n            try {\n                const imported = JSON.parse(e.target.result);\n\n                if (!Array.isArray(imported)) {\n                    alert(\"O arquivo JSON nÃ£o contÃ©m uma lista vÃ¡lida de cantos.\");\n                    return;\n                }\n\n                // Normalizar e gerar IDs novos\n                const normalized = imported.map((item, idx) => ({\n                    id: Date.now() + idx,\n                    numero: item.numero || \"\",\n                    nome: item.nome || \"\",\n                    composer: item.composer || \"\",\n                    category: item.category || \"Geral\",\n                }));\n\n                setSongsData((prev) => [...prev, ...normalized]);\n\n                alert(`Importados ${normalized.length} cantos da biblioteca JSON.`);\n            } catch (error) {\n                alert(\"Arquivo JSON invÃ¡lido.\");\n            }\n        };\n\n        reader.readAsText(file, \"utf-8\");\n    };\n\n    /* ------------------ PDF generation (A4 list and team 4-per-page) ------------------ */\n\n    // CMV Minimalist A4 list\n    const generatePDF = () => {\n        const doc = new jsPDF({ unit: \"pt\", format: \"a4\" });\n\n        const margin = 35;\n        const pageWidth = doc.internal.pageSize.getWidth();\n        const maxWidth = pageWidth - margin * 2;\n\n        let y = margin;\n\n        // CabeÃ§alho CMV\n        y += 12;\n        doc.setDrawColor(199, 126, 74);\n        doc.line(margin, y, pageWidth - margin, y);\n        y += 14;\n\n        doc.setFont(\"times\", \"bold\");\n        doc.setFontSize(20);\n\n        doc.setFontSize(16);\n        doc.text(massName || \"Planejador de Missas\", pageWidth / 2, y, { align: \"center\" });\n        y += 20;\n\n        doc.setFont(\"times\", \"normal\");\n        doc.setFontSize(11);\n        doc.text(`Data: ${massDate}`, pageWidth / 2, y, { align: \"center\" });\n        y += 20;\n\n        doc.setDrawColor(199, 126, 74);\n        doc.line(margin, y, pageWidth - margin, y);\n        y += 25;\n\n        // Corpo â€“ lista litÃºrgica\n        const flat = flattenSelected(selectedSongs, sections);\n\n        doc.setFont(\"times\", \"bold\");\n        doc.setFontSize(14);\n\n        let lastSection = null;\n\n        for (const item of flat) {\n            const canto = `${item.numero ? item.numero + \" â€” \" : \"\"}${item.nome}`;\n\n            // Mostra o tÃ­tulo da seÃ§Ã£o somente quando mudar\n            if (item.section !== lastSection) {\n                lastSection = item.section;\n\n                doc.setFont(\"times\", \"bold\");\n                doc.setFontSize(13);\n\n                const sectionLines = doc.splitTextToSize(item.section, maxWidth);\n                doc.text(sectionLines, margin, y);\n                y += sectionLines.length * 16;\n            }\n\n            // Nome do canto (sempre)\n            doc.setFont(\"times\", \"normal\");\n            doc.setFontSize(12);\n\n            const cantoLines = doc.splitTextToSize(canto, maxWidth);\n            doc.text(cantoLines, margin + 10, y);\n            y += cantoLines.length * 14;\n\n            // Compositor\n            if (item.composer) {\n                doc.setFont(\"times\", \"italic\");\n                doc.setFontSize(10);\n                const comp = doc.splitTextToSize(`Compositor: ${item.composer}`, maxWidth);\n                doc.text(comp, margin + 10, y);\n                y += comp.length * 12;\n            }\n\n            y += 12;\n\n            // Quebra de pÃ¡gina\n            if (y > doc.internal.pageSize.getHeight() - margin) {\n                doc.addPage();\n                y = margin;\n            }\n        }\n\n        const filename = `${(massName || \"missal\").replace(/\\s+/g, \"_\")}_${massDate}.pdf`;\n        doc.save(filename);\n    };\n\n    // Team PDF: adaptado para 1 pÃ¡gina (atÃ© 10 cantos) ou 2 pÃ¡ginas (11+ cantos)\n    const generateTeamPDF = () => {\n        const doc = new jsPDF({ unit: \"pt\", format: \"a4\" });\n\n        const pageWidth = doc.internal.pageSize.getWidth();\n        const pageHeight = doc.internal.pageSize.getHeight();\n        const margin = 30;\n\n        const colWidth = (pageWidth - margin * 2) / 2;\n        const maxTextWidth = colWidth - 40;\n\n        const flat = flattenSelected(selectedSongs, sections);\n\n        const linesFull = flat.map((it) => ({\n            section: it.section,\n            canto: `${it.numero ? it.numero + \" â€” \" : \"\"}${it.nome}`\n        }));\n\n        /* -------------------------------\n           FunÃ§Ã£o melhorada para o bloco\n           (borda dinÃ¢mica + tÃ­tulo multiline)\n        --------------------------------*/\n        const drawBlock = (x, y) => {\n            let cursorY = y + 20;\n\n            // === 1. TÃTULO MULTILINHA ===\n            doc.setFont(\"times\", \"bold\");\n            doc.setFontSize(13);\n\n            const titleLines = doc.splitTextToSize(massName || \"Planejador de Missas\", maxTextWidth);\n            doc.text(titleLines, x + 12, cursorY);\n            cursorY += titleLines.length * 14;\n\n            // === 2. DATA ===\n            doc.setFont(\"times\", \"italic\");\n            doc.setFontSize(10);\n            doc.text(`Data: ${massDate}`, x + 12, cursorY);\n            cursorY += 14;\n\n            // === 3. LINHA DIVISÃ“RIA ===\n            doc.setDrawColor(199, 126, 74);\n            doc.line(x + 12, cursorY, x + colWidth - 28, cursorY);\n            cursorY += 12;\n\n            // === 4. LISTA DE CANTOS ===\n            doc.setFont(\"times\", \"normal\");\n            doc.setFontSize(11);\n\n            let lastSection = null;\n\n            linesFull.forEach((entry) => {\n                // MOSTRAR A SEÃ‡ÃƒO APENAS UMA VEZ\n                if (entry.section !== lastSection) {\n                    lastSection = entry.section;\n\n                    doc.setFont(\"times\", \"bold\");\n                    doc.setFontSize(11);\n                    const secLines = doc.splitTextToSize(entry.section.toUpperCase(), maxTextWidth);\n                    doc.text(secLines, x + 12, cursorY);\n                    cursorY += secLines.length * 12;\n                }\n\n                // CANTO\n                doc.setFont(\"times\", \"normal\");\n                doc.setFontSize(11);\n                const cantoLines = doc.splitTextToSize(entry.canto, maxTextWidth);\n                doc.text(cantoLines, x + 12, cursorY);\n                cursorY += cantoLines.length * 12;\n\n                cursorY += 6; // espaÃ§amento\n            });\n\n            // === 5. DESENHAR BORDA DINÃ‚MICA ===\n            const blockHeight = cursorY - y + 10; // sempre atÃ© o final do Ãºltimo canto\n\n            doc.setDrawColor(199, 126, 74);\n            doc.rect(x, y, colWidth - 8, blockHeight);\n        };\n\n        // ===================================\n        // LISTA PEQUENA â€” 1 pÃ¡gina, 4 blocos\n        // ===================================\n        if (linesFull.length \u003c= 10) {\n            drawBlock(margin, margin);\n            drawBlock(margin + colWidth, margin);\n            drawBlock(margin, margin + pageHeight / 2);\n            drawBlock(margin + colWidth, margin + pageHeight / 2);\n\n            const filename = `${(massName || \"missal\")}_equipe_${massDate}.pdf`;\n            return doc.save(filename);\n        }\n\n        // ===================================\n        // LISTA GRANDE â€” 2 pÃ¡ginas, 2 blocos\n        // ===================================\n        drawBlock(margin, margin);\n        drawBlock(margin + colWidth, margin);\n\n        doc.addPage();\n        drawBlock(margin, margin);\n        drawBlock(margin + colWidth, margin);\n\n        const filename = `${(massName || \"missal\")}_equipe_${massDate}.pdf`;\n        doc.save(filename);\n    };\n\n    /* ------------------ Import/Export JSON (mantive) ------------------ */\n\n    const importJSON = (file) => {\n        if (!file) return;\n        const reader = new FileReader();\n        reader.onload = (e) => {\n            try {\n                const parsed = JSON.parse(e.target.result);\n                setMassName(parsed.missa || \"\");\n                setMassDate(parsed.data || \"\");\n                if (parsed.cantos && typeof parsed.cantos === \"object\") setSelectedSongs(parsed.cantos);\n                alert(\"Arquivo JSON importado.\");\n            } catch {\n                alert(\"Arquivo JSON invÃ¡lido.\");\n            }\n        };\n        reader.readAsText(file, \"utf-8\");\n    };\n\n    const exportJSON = () => {\n        // ordenar seÃ§Ãµes conforme a ordem litÃºrgica atual\n        const ordered = {};\n        sections.forEach(sec => {\n            if (selectedSongs[sec]) {\n                ordered[sec] = selectedSongs[sec];\n            }\n        });\n\n        const payload = {\n            missa: massName,\n            data: massDate,\n            cantos: ordered\n        };\n\n        const blob = new Blob([JSON.stringify(payload, null, 2)], { type: \"application/json\" });\n        downloadBlob(blob, `${(massName || \"missal\").replace(/\\s+/g, \"_\")}_${massDate}.json`);\n    };\n\n    /* ------------------ UI ------------------ */\n\n    return (\n        \u003c>\n            \u003cHeader />\n\n            \u003cdiv\n                className=\"max-w-6xl mx-auto mt-4 mb-6 p-4 rounded-xl\"\n                style={{ backgroundColor: \"#0d6efd\" }}   // â† azul bonito\n            >\n                \u003cbutton\n                    onClick={() => setShowHelp(true)}\n                    className=\"px-4 py-2 rounded-xl btn-cmv-outline\"\n                    style={{ backgroundColor: \"white\", color: \"#0044aa\", fontWeight: \"600\" }}\n                >\n                    ðŸ“˜ Como usar o Missal-Planner\n                \u003c/button>\n            \u003c/div>\n\n            \u003cdiv className=\"min-h-screen p-6\" style={{ background: \"var(--cmv-bg, #f1e5ae)\", color: \"var(--cmv-text, #222)\", fontFamily: \"var(--font-sans, system-ui)\" }}>\n                \u003cdiv className=\"max-w-6xl mx-auto mb-6\">\n                    \u003cinput type=\"text\" placeholder=\"Nome da Missa\" value={massName} onChange={(e) => setMassName(e.target.value)}\n                        className=\"w-full p-2 text-1xl font-bold rounded-xl shadow-sm\"\n                        style={{ background: \"white\", color: \"var(--cmv-text)\", fontFamily: \"var(--font-heading)\", borderBottom: \"4px solid #c77e4a\" }} />\n\n                    \u003cdiv className=\"mt-3\">\n                        \u003clabel className=\"text-sm mb-1 block\" style={{ color: \"var(--cmv-muted)\" }}>Inserir Data\u003c/label>\n                        \u003cinput type=\"date\" value={massDate} onChange={(e) => setMassDate(e.target.value)} className=\"p-2 rounded\" style={{ background: \"white\", border: \"1px solid var(--cmv-primary)\", color: \"var(--cmv-text)\" }} />\n                    \u003c/div>\n                \u003c/div>\n\n                \u003cdiv className=\"max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                    \u003cdiv className=\"col-span-2\">\n                        \u003cdiv className=\"p-4 rounded-xl shadow-md cmv-border\" style={{ background: \"white\" }}>\n\n                            {/* Barra principal reorganizada */}\n                            \u003cdiv className=\"w-full flex flex-wrap items-center gap-4 mb-6\">\n\n                                {/* BotÃ£o Abrir Lista de Cantos (primeiro botÃ£o visÃ­vel abaixo do tÃ­tulo/data) */}\n                                \u003cbutton\n                                    onClick={() => {\n                                        setSavedLists(getSavedLists());\n                                        setShowSavedLists(true);\n                                    }}\n                                    className=\"px-5 py-2 rounded-xl font-semibold btn-cmv-outline\"\n                                >\n                                    ðŸ“‚ Abrir Lista de Cantos\n                                \u003c/button>\n\n                                \u003clabel className=\"px-5 py-2 rounded-xl cursor-pointer font-semibold btn-cmv-outline\">\n                                    Importar lista .json\n                                    \u003cinput\n                                        type=\"file\"\n                                        accept=\".json\"\n                                        onChange={(e) => importJSON(e.target.files[0])}\n                                        className=\"hidden\"\n                                    />\n                                \u003c/label>\n\n                                \u003cbutton\n                                    onClick={() => setShowSettings(true)}\n                                    className=\"px-5 py-2 rounded-xl font-semibold btn-cmv-outline\"\n                                >\n                                    âš™ï¸ ConfiguraÃ§Ãµes\n                                \u003c/button>\n                            \u003c/div>\n\n                            \u003cFilters globalSearch={globalSearch} setGlobalSearch={setGlobalSearch}\n                                filterCategory={filterCategory} setFilterCategory={setFilterCategory}\n                                filterComposer={filterComposer} setFilterComposer={setFilterComposer}\n                                sortMode={sortMode} setSortMode={setSortMode}\n                                categoriesList={categoriesList} />\n\n                            \u003cdiv className=\"mt-4\">\n                                \u003cLibraryPanel songs={filteredSongs} onAdd={handleLibraryAdd} onEdit={handleLibraryEdit} />\n                            \u003c/div>\n\n                            \u003cdiv className=\"relative inline-block\">\n                                \u003cbutton\n                                    onClick={() => setShowAddModal(true)}\n                                    className=\"px-5 py-2 rounded-xl font-semibold btn-cmv-outline\"\n                                >\n                                    Novo Canto\n                                \u003c/button>\n                            \u003c/div>\n\n\n                        \u003c/div>\n\n                        \u003cdiv className=\"mt-6\">\n                            \u003cSelectedSongsPanel selectedSongs={selectedSongs} sections={sections} onRemove={({ section, indexInSection }) => removeFromSection(section, indexInSection ?? null)} onEdit={({ section, indexInSection }) => openEditSelectedItem(section, indexInSection)} />\n                        \u003c/div>\n\n                        \u003cdiv className=\"mt-6 flex flex-wrap gap-3\">\n                            \u003cbutton onClick={saveCurrentList} className=\"px-3 py-2 rounded btn-cmv-outline\">\n                                ðŸ’¾ Salvar Lista\n                            \u003c/button>\n\n                            \u003cbutton onClick={exportJSON} className=\"px-3 py-2 rounded btn-cmv-outline\">Export .json\u003c/button>\n\n                            \u003cbutton onClick={generatePDF} className=\"px-3 py-2 rounded btn-cmv-outline\">Gerar PDF\u003c/button>\n\n                            \u003cbutton onClick={generateTeamPDF} className=\"px-3 py-2 rounded btn-cmv-outline\">PDF Equipe\u003c/button>\n\n                            {/* NOVO BOTÃƒO PARA ABRIR A PROJEÃ‡ÃƒO */}\n                            \u003cbutton\n                                onClick={() => {\n                                    const flat = flattenSelected(selectedSongs, sections);\n\n                                    // ðŸ’¡ ProteÃ§Ã£o para ambiente navegador (nÃ£o Electron)\n                                    if (!window.missalAPI?.openOperatorAndProjection) {\n                                        alert(\n                                            \"A projeÃ§Ã£o funciona somente na versÃ£o Electron.\\n\" +\n                                            \"Instale o aplicativo para usar o Painel Operador e a ProjeÃ§Ã£o.\"\n                                        );\n                                        return;\n                                    }\n\n                                    window.missalAPI.openOperatorAndProjection(flat);\n                                }}\n                                className=\"px-3 py-2 rounded btn-cmv-outline\"\n                            >\n                                ðŸŽ¥ Abrir ProjeÃ§Ã£o\n                            \u003c/button>\n                        \u003c/div>   {/* \u003c-- ESTA LINHA QUE FALTAVA!!! */}\n\n                    \u003cdiv className=\"col-span-1\">\n                        \u003cSidebarPanel mode={mode} setMode={setMode} modes={modes} sections={sections} categoriesList={categoriesList} setFilterCategory={setFilterCategory} setSelectedSongs={setSelectedSongs} />\n                    \u003c/div>\n                \u003c/div>\n            \u003c/div>\n\n            {/* Modal ConfiguraÃ§Ãµes */}\n            {showSettings && (\n                \u003cdiv className=\"fixed inset-0 bg-black/40 flex items-center justify-center z-50\">\n                    \u003cdiv className=\"p-6 rounded-xl shadow-xl cmv-border\"\n                        style={{ background: \"white\", width: \"420px\" }}>\n\n                        \u003ch2 className=\"h-liturgico mb-4\"\n                            style={{ fontSize: \"1.6rem\" }}>\n                            âš™ï¸ ConfiguraÃ§Ãµes\n                        \u003c/h2>\n\n                        \u003cdiv className=\"space-y-3\">\n\n                            \u003clabel className=\"px-4 py-2 rounded-xl cursor-pointer btn-cmv-outline w-full block text-left\">\n                                Importar CSV â€” Biblioteca\n                                \u003cinput\n                                    type=\"file\"\n                                    accept=\".csv\"\n                                    ref={fileInputLibraryRef}\n                                    onChange={(e) => importLibraryCSV(e.target.files[0])}\n                                    className=\"hidden\"\n                                />\n                            \u003c/label>\n\n                            \u003cbutton\n                                onClick={exportLibraryAsCSV}\n                                className=\"px-4 py-2 rounded-xl btn-cmv-outline w-full\">\n                                Exportar CSV â€” Biblioteca\n                            \u003c/button>\n\n\n                            \u003cbutton\n                                onClick={exportLibraryJSON}\n                                className=\"px-4 py-2 rounded-xl btn-cmv-outline w-full\"\n                            >\n                                Exportar Biblioteca â€” JSON\n                            \u003c/button>\n\n                            \u003clabel className=\"px-4 py-2 rounded-xl cursor-pointer btn-cmv-outline w-full block text-left\">\n                                Importar Biblioteca â€” JSON\n                                \u003cinput\n                                    type=\"file\"\n                                    accept=\".json\"\n                                    onChange={(e) => importLibraryJSON(e.target.files[0])}\n                                    className=\"hidden\"\n                                />\n                            \u003c/label>\n\n                            \u003cbutton\n                                onClick={openDeleteLibraryModal}\n                                className=\"px-4 py-2 rounded-xl btn-cmv-outline w-full\"\n                            >\n\n                                Eliminar canto da Biblioteca\n                            \u003c/button>\n\n                        \u003c/div>\n\n                        \u003cdiv className=\"flex justify-end mt-6\">\n                            \u003cbutton\n                                onClick={() => setShowSettings(false)}\n                                className=\"px-4 py-2 rounded-xl btn-cmv-outline\">\n                                Fechar\n                            \u003c/button>\n                        \u003c/div>\n\n                    \u003c/div>\n                \u003c/div>\n            )}\n\n            {/* Modal Eliminar canto da Biblioteca */}\n            {showDeleteLibraryModal && (\n                \u003cdiv className=\"fixed inset-0 bg-black/40 flex items-center justify-center z-50\">\n                    \u003cdiv className=\"p-6 rounded-xl shadow-xl cmv-border\"\n                        style={{ background: \"white\", width: \"760px\", maxHeight: \"80vh\", overflowY: \"auto\" }}>\n\n                        \u003ch2 className=\"h-liturgico mb-4\" style={{ fontSize: \"1.6rem\" }}>\n                            Eliminar canto da Biblioteca\n                        \u003c/h2>\n\n                        \u003cdiv className=\"grid grid-cols-3 gap-4\">\n                            {songsData.length === 0 && (\n                                \u003cp>Nenhum canto na biblioteca.\u003c/p>\n                            )}\n\n                            {songsData.map((s) => (\n                                \u003cdiv key={s.id} className=\"p-4 border rounded-md bg-white\">\n                                    \u003cdiv className=\"font-bold\" style={{ color: \"var(--cmv-text)\" }}>\n                                        {s.nome || s.title}\n                                    \u003c/div>\n\n                                    \u003cdiv style={{ color: \"var(--cmv-muted)\", marginBottom: \"0.5rem\" }}>\n                                        {s.numero ? `#${s.numero}` : \"\"} {s.compositor ? ` â€” ${s.compositor}` : \"\"}\n                                    \u003c/div>\n\n                                    \u003cbutton\n                                        className=\"px-3 py-1 rounded bg-red-600 text-white\"\n                                        onClick={() => {\n                                            if (window.confirm(`Eliminar o canto \"${s.nome || s.title}\"?`)) {\n                                                deleteSongFromLibrary(s.id);\n                                            }\n                                        }}\n                                    >\n                                        Eliminar\n                                    \u003c/button>\n                                \u003c/div>\n                            ))}\n                        \u003c/div>\n\n                        \u003cdiv className=\"flex justify-end mt-6\">\n                            \u003cbutton\n                                onClick={() => setShowDeleteLibraryModal(false)}\n                                className=\"px-4 py-2 rounded-xl btn-cmv-outline\"\n                            >\n                                Fechar\n                            \u003c/button>\n                        \u003c/div>\n\n                    \u003c/div>\n                \u003c/div>\n            )}\n\n            {/* Modal de Ajuda */}\n            {showHelp && (\n                \u003cdiv className=\"fixed inset-0 bg-black/40 flex items-center justify-center z-50\">\n                    \u003cdiv className=\"p-6 rounded-xl shadow-xl cmv-border\"\n                        style={{ background: \"white\", width: \"620px\", maxHeight: \"80vh\", overflowY: \"auto\" }}>\n\n                        \u003ch2 className=\"h-liturgico mb-4\" style={{ fontSize: \"1.6rem\" }}>\n                            ðŸ“˜ Como usar o Missal-Planner\n                        \u003c/h2>\n\n                        \u003cp style={{ marginBottom: \"1rem\", color: \"var(--cmv-text)\" }}>\n                            O Missal-Planner nasceu do desejo de ajudar as equipes de canto\n                            da Comunidade MissionÃ¡ria de Villaregia a organizar todos os\n                            momentos de oraÃ§Ã£o cantada das Missas e das AdoraÃ§Ãµes.\n                        \u003c/p>\n\n                        \u003cp className=\"mb-2\">\n                            Ele foi pensado para oferecer:\n                        \u003c/p>\n\n                        \u003cul className=\"list-disc ml-5 space-y-1\" style={{ color: \"var(--cmv-text)\" }}>\n                            \u003cli>Uma biblioteca de cantos sempre atualizada\u003c/li>\n                            \u003cli>Escolha rÃ¡pida dos cantos por momentos litÃºrgicos\u003c/li>\n                            \u003cli>Planejamento de Missa e AdoraÃ§Ã£o com clareza\u003c/li>\n                            \u003cli>GeraÃ§Ã£o automÃ¡tica de PDFs para a equipe\u003c/li>\n                            \u003cli>ExportaÃ§Ã£o e importaÃ§Ã£o em CSV ou JSON\u003c/li>\n                            \u003cli>Autosave automÃ¡tico: o app nunca perde seu trabalho\u003c/li>\n                        \u003c/ul>\n\n                        \u003ch3 className=\"mt-4 font-semibold\" style={{ color: \"var(--cmv-text)\" }}>\n                            Como funciona:\n                        \u003c/h3>\n\n                        \u003col className=\"list-decimal ml-5 space-y-1\" style={{ color: \"var(--cmv-text)\" }}>\n                            \u003cli>Escolha o modo (Missa / AdoraÃ§Ã£o).\u003c/li>\n                            \u003cli>Filtre, procure e selecione cantos na biblioteca.\u003c/li>\n                            \u003cli>Adicione cantos aos momentos litÃºrgicos desejados.\u003c/li>\n                            \u003cli>Edite ou remova cantos conforme necessÃ¡rio.\u003c/li>\n                            \u003cli>Gere PDFs para impressÃ£o.\u003c/li>\n                            \u003cli>Use a seÃ§Ã£o ConfiguraÃ§Ãµes para importar/exportar bibliotecas personalizadas.\u003c/li>\n                        \u003c/ol>\n\n                        \u003cdiv className=\"flex justify-end mt-6\">\n                            \u003cbutton\n                                onClick={() => setShowHelp(false)}\n                                className=\"px-4 py-2 rounded-xl btn-cmv-outline\"\n                            >\n                                Fechar\n                            \u003c/button>\n                        \u003c/div>\n\n                    \u003c/div>\n                \u003c/div>\n            )}\n\n            {showSavedLists && (\n                \u003cdiv className=\"fixed inset-0 bg-black/40 flex items-center justify-center z-50\">\n                    \u003cdiv className=\"p-6 rounded-xl shadow-xl cmv-border\"\n                        style={{ background: \"white\", width: \"520px\", maxHeight: \"80vh\", overflowY: \"auto\" }}>\n\n                        \u003ch2 className=\"h-liturgico mb-4\" style={{ fontSize: \"1.6rem\" }}>\n                            ðŸ“‚ Listas Salvas\n                        \u003c/h2>\n\n                        {savedLists.length === 0 && (\n                            \u003cp>Nenhuma lista salva ainda.\u003c/p>\n                        )}\n\n                        {savedLists.map(entry => (\n                            \u003cdiv key={entry.id} className=\"p-3 border rounded mb-3 bg-white\">\n                                \u003cdiv className=\"font-bold\">{entry.missa}\u003c/div>\n                                \u003cdiv className=\"text-sm\" style={{ color: \"var(--cmv-muted)\" }}>{entry.data}\u003c/div>\n\n                                \u003cdiv className=\"mt-2\">\n                                    \u003cbutton\n                                        className=\"px-3 py-1 mr-2 rounded btn-cmv-outline\"\n                                        onClick={() => openSavedList(entry)}\n                                    >\n                                        Abrir\n                                    \u003c/button>\n\n                                    \u003cbutton\n                                        className=\"px-3 py-1 rounded bg-red-600 text-white\"\n                                        onClick={() => {\n                                            if (window.confirm(\"Eliminar esta lista?\")) deleteSavedList(entry.id);\n                                        }}\n                                    >\n                                        Eliminar\n                                    \u003c/button>\n                                \u003c/div>\n                            \u003c/div>\n                        ))}\n\n                        \u003cdiv className=\"flex justify-end mt-4\">\n                            \u003cbutton\n                                className=\"px-4 py-2 rounded-xl btn-cmv-outline\"\n                                onClick={() => setShowSavedLists(false)}\n                            >\n                                Fechar\n                            \u003c/button>\n                        \u003c/div>\n                    \u003c/div>\n                \u003c/div>\n            )}\n\n            \u003cModalAddSong visible={showAddModal} onClose={() => setShowAddModal(false)} draft={newSongDraft} setDraft={setNewSongDraft} onSave={saveNewSong} />\n            \u003cModalSelectSections visible={showSectionModal} pendingSong={pendingSong} sections={sections} pendingSelections={pendingSelections} setPendingSelections={setPendingSelections} onConfirm={confirmSectionSelection} onClose={() => setShowSectionModal(false)} />\n        \u003c/>\n    );\n}\n","loc":{"line":1142,"column":11,"index":45309}}
              try {
                const { ErrorOverlay } = await import("/@vite/client")
                document.body.appendChild(new ErrorOverlay(error))
              } catch {
                const h = (tag, text) => {
                  const el = document.createElement(tag)
                  el.textContent = text
                  return el
                }
                document.body.appendChild(h('h1', 'Internal Server Error'))
                document.body.appendChild(h('h2', error.message))
                document.body.appendChild(h('pre', error.stack))
                document.body.appendChild(h('p', '(Error overlay failed to load)'))
              }
            </script>
          </head>
          <body>
          </body>
        </html>
      